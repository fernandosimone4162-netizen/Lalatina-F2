<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>LaLatina - Fase 1</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
    font-family: Arial, sans-serif;
    background: #0f172a;
    color: #e5e7eb;
    text-align: center;
    padding: 20px;
}
.container {
    max-width: 650px;
    margin: auto;
    background: #020617;
    padding: 20px;
    border-radius: 10px;
}
h1 { color: #38bdf8; }
.question {
    font-size: 24px;
    margin: 20px 0;
}
input {
    width: 90%;
    padding: 10px;
    font-size: 16px;
    border-radius: 6px;
    border: none;
}
button {
    margin-top: 10px;
    padding: 10px 15px;
    font-size: 16px;
    border-radius: 6px;
    border: none;
    cursor: pointer;
}
.btn-main { background: #38bdf8; color: #020617; }
.btn-voice { background: #22c55e; color: #020617; }
.feedback { margin-top: 15px; font-size: 18px; }
.hint { margin-top: 10px; font-size: 16px; color: #facc15; }
</style>
</head>
<body>

<div class="container">
    <h1>LaLatina ‚Äì Fase 1</h1>
    <p>Traduza do ingl√™s para qualquer l√≠ngua (exceto ingl√™s).</p>

    <div class="question" id="question"></div>

    <input type="text" id="answer" placeholder="Digite ou fale a tradu√ß√£o">

    <br>

    <button class="btn-main" onclick="checkAnswer()">Confirmar</button>
    <button class="btn-voice" onclick="startVoice()">üé§ Falar</button>
    <button onclick="repeatQuestion()">üîÅ Ouvir pergunta</button>

    <div class="feedback" id="feedback"></div>
    <div class="hint" id="hint"></div>
</div>

<script>
const questions = [
{ text:"Hi", hint:"Sauda√ß√£o curta e informal.", weight:1 },
{ text:"Hello", hint:"Sauda√ß√£o comum.", weight:1 },
{ text:"How are you?", hint:"Pergunta sobre estado.", weight:1 },
{ text:"I am fine", hint:"Resposta positiva.", weight:1 },
{ text:"What is your name?", hint:"Pergunta sobre nome.", weight:1 },
{ text:"My name is John", hint:"Apresenta√ß√£o.", weight:1 },
{ text:"Good morning", hint:"Usado pela manh√£.", weight:1 },
{ text:"Good afternoon", hint:"Usado √† tarde.", weight:1 },
{ text:"Good night", hint:"Usado √† noite.", weight:1 },
{ text:"Thank you", hint:"Gratid√£o.", weight:1 },
{ text:"You're welcome", hint:"Resposta a agradecimento.", weight:2 },
{ text:"Please", hint:"Pedido educado.", weight:1 },
{ text:"Excuse me", hint:"Chamar aten√ß√£o.", weight:2 },
{ text:"Sorry", hint:"Pedido de desculpa.", weight:1 },
{ text:"How much is this?", hint:"Pergunta de pre√ßo.", weight:2 },
{ text:"Where are you from?", hint:"Origem da pessoa.", weight:2 },
{ text:"I am from Brazil", hint:"Resposta de origem.", weight:2 },
{ text:"Do you speak Portuguese?", hint:"Pergunta de idioma.", weight:2 },
{ text:"Yes, I do", hint:"Resposta afirmativa.", weight:2 },
{ text:"No, I don't", hint:"Resposta negativa.", weight:2 },
{ text:"Can you help me?", hint:"Pedido de ajuda.", weight:2 },
{ text:"I don't understand", hint:"Expressa dificuldade.", weight:2 },
{ text:"Can you repeat?", hint:"Pedido de repeti√ß√£o.", weight:2 },
{ text:"What time is it?", hint:"Pergunta sobre horas.", weight:2 },
{ text:"See you later", hint:"Despedida informal.", weight:2 },
{ text:"Goodbye", hint:"Despedida formal.", weight:1 },
{ text:"Have a nice day", hint:"Desejo positivo.", weight:2 },
{ text:"What's going on?", hint:"Pergunta informal.", weight:3 },
{ text:"I'm tired", hint:"Estado f√≠sico.", weight:2 },
{ text:"I'm hungry", hint:"Necessidade.", weight:2 },
{ text:"I'm thirsty", hint:"Necessidade.", weight:2 },
{ text:"Where is the bathroom?", hint:"Local importante.", weight:3 },
{ text:"How old are you?", hint:"Pergunta de idade.", weight:3 },
{ text:"I like this", hint:"Opini√£o positiva.", weight:2 },
{ text:"I don't like this", hint:"Opini√£o negativa.", weight:2 },
{ text:"What do you want?", hint:"Desejo.", weight:3 },
{ text:"I want water", hint:"Pedido simples.", weight:2 },
{ text:"Let's go", hint:"Convite.", weight:2 },
{ text:"Wait a moment", hint:"Pedido de espera.", weight:2 },
{ text:"Be careful", hint:"Aviso.", weight:3 },
{ text:"No problem", hint:"Resposta positiva.", weight:2 },
{ text:"Of course", hint:"Confirma√ß√£o.", weight:2 },
{ text:"Maybe", hint:"Incerteza.", weight:2 },
{ text:"I think so", hint:"Opini√£o leve.", weight:3 },
{ text:"I don't know", hint:"Desconhecimento.", weight:2 },
{ text:"What is this?", hint:"Identifica√ß√£o.", weight:2 },
{ text:"Who are you?", hint:"Identidade.", weight:2 },
{ text:"Nice to meet you", hint:"Apresenta√ß√£o educada.", weight:2 }
];

// ---------- ALGORITMO ADAPTATIVO REAL ----------
let lastIndex = -1;
let attempts = 0;

function chooseQuestion() {
    let pool = [];
    questions.forEach((q, i) => {
        for (let j = 0; j < q.weight; j++) pool.push(i);
    });
    let next;
    do {
        next = pool[Math.floor(Math.random() * pool.length)];
    } while (next === lastIndex);
    lastIndex = next;
    return next;
}

let current = chooseQuestion();

function speak(text, lang="en-US") {
    const msg = new SpeechSynthesisUtterance(text);
    msg.lang = lang;
    speechSynthesis.speak(msg);
}

function loadQuestion() {
    attempts = 0;
    document.getElementById("hint").innerText = "";
    document.getElementById("feedback").innerText = "";
    document.getElementById("question").innerText = questions[current].text;
    speak(questions[current].text);
}

function repeatQuestion() {
    speak(questions[current].text);
}

function checkAnswer() {
    const answer = document.getElementById("answer").value.trim();
    if (!answer) return;

    attempts++;

    if (/^[a-zA-Z\s?!.,]+$/.test(answer)) {
        document.getElementById("feedback").innerText = "N√£o responda em ingl√™s.";
        return;
    }

    document.getElementById("feedback").innerText = "Resposta correta!";
    speak("I am very good");

    questions[current].weight = Math.max(1, questions[current].weight - 1);

    setTimeout(() => {
        document.getElementById("answer").value = "";
        current = chooseQuestion();
        loadQuestion();
    }, 1400);
}

function startVoice() {
    const R = window.SpeechRecognition || window.webkitSpeechRecognition;
    if (!R) return alert("Voz n√£o suportada.");
    const rec = new R();
    rec.lang = "pt-BR";
    rec.start();
    rec.onresult = e => {
        document.getElementById("answer").value = e.results[0][0].transcript;
    };
}

setInterval(() => {
    if (attempts === 3) {
        document.getElementById("hint").innerText =
            "Dica: " + questions[current].hint;
    }
}, 300);

loadQuestion();
</script>

</body>
</html>
